diff -urN pacman-5.2.2/lib/libalpm/util.c pacman/lib/libalpm/util.c
--- pacman-5.2.2/lib/libalpm/util.c	2020-06-26 01:04:50.000000000 -0400
+++ pacman/lib/libalpm/util.c	2020-09-02 23:34:47.047255484 -0400
@@ -34,6 +34,11 @@
 #include <fnmatch.h>
 #include <poll.h>
 
+/* no MSG_NOSIGNAL support */
+#ifndef MSG_NOSIGNAL
+#define MSG_NOSIGNAL 0x0
+#endif
+
 /* libarchive */
 #include <archive.h>
 #include <archive_entry.h>
@@ -473,6 +478,8 @@
 		}
 	}
 
+	signal(SIGPIPE, SIG_IGN);
+
 	nwrite = send(fd, buf, *buf_size, MSG_NOSIGNAL);
 
 	if(nwrite != -1) {
@@ -556,8 +563,11 @@
 	int *i, signals[] = {
 		SIGABRT, SIGALRM, SIGBUS, SIGCHLD, SIGCONT, SIGFPE, SIGHUP, SIGILL,
 		SIGINT, SIGKILL, SIGPIPE, SIGQUIT, SIGSEGV, SIGSTOP, SIGTERM, SIGTSTP,
-		SIGTTIN, SIGTTOU, SIGUSR1, SIGUSR2, SIGPOLL, SIGPROF, SIGSYS, SIGTRAP,
+		SIGTTIN, SIGTTOU, SIGUSR1, SIGUSR2, SIGPROF, SIGSYS, SIGTRAP,
 		SIGURG, SIGVTALRM, SIGXCPU, SIGXFSZ,
+#ifndef __APPLE__
+		SIGPOLL,
+#endif
 		0
 	};
 	struct sigaction def;
